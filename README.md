# üìù Full Stack Intern Assignment - Zeidler Group - Node.JS Express.JS Node-Cron Nodemailer Prisma PostgreSQL & Docker

This guide provides an overview of the codebase, the functionality of the app, and detailed instructions on how to set up and run the app. Make sure to follow all steps carefully for the app to run smoothly.

## üìñ Overview

This is a **Dockerized** and authentication-protected Todo App using **Node.js**, **Express.js**, **Node-Cron**, **Nodemailer**, **bcrypt**, **JWT authentication**, **Prisma**, and **PostgreSQL**. The app allows users to:

- **Register**: Create a new account.
- **Login**/**Logout**: Authenticate and receive a JWT token/Logout of application and erase token.
- **Manage Todos**: Perform auth protected CRUD operations on their own todo tasks after logging in.
- **Email Reminders**: Receive email reminders for todo completion 30 mins before due time.

## üóÇÔ∏è Project Structure

Here‚Äôs the corrected and complete project structure diagram for the auth-protected Todo App:

```
todo-app-with-email-reminders/
‚îÇ
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ index.html              # The frontend HTML file for authentication and todo management
‚îÇ
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma           # The frontend HTML file for authentication and todo management
‚îÇ   ‚îî‚îÄ‚îÄ migrations/             #
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ generated/prisma        # Files generated after running npx prisma generate
‚îÇ   ‚îú‚îÄ‚îÄ controllers/            # (Optional) For future separation of concerns
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ authMiddleware.js    # Middleware for verifying JWT and protecting routes
‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authRoutes.js        # Routes for user registration and login
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ todoRoutes.js        # Routes for authenticated CRUD operations on todos
‚îÇ   ‚îú‚îÄ‚îÄ mailer.js                # Email reminder service and provider config file 
‚îÇ   ‚îú‚îÄ‚îÄ prismaClient.js          # Prisma client database setup and table creation
‚îÇ   ‚îî‚îÄ‚îÄ server.js                # Main server entry point that sets up routing, middleware and runs the cron-job.
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile                   # Docker container setup instructions
‚îú‚îÄ‚îÄ docker-compose.yaml          # Docker setup config file
‚îú‚îÄ‚îÄ package.json                 # Project dependencies and scripts
‚îú‚îÄ‚îÄ package-lock.json            # Lockfile for exact dependency versions
‚îú‚îÄ‚îÄ .gitignore                   # Files to be ignored when committing project publicly
‚îî‚îÄ‚îÄ .env                         # File containing passwords, secret keys and other private information not to be shared publicly
```

## üîß Environment Variables

Create a `.env` file in the project root using the template below:(Also shown in the .env.example file)

| Variable | Description |
|-----------|-------------|
| `DATABASE_URL` | PostgreSQL connection string (e.g., `postgresql://postgres:postgres@db:5432/todoapp`) |
| `JWT_SECRET` | Secret key for signing JWT tokens |
| `EMAIL_USER` | Gmail address used to send reminder emails |
| `EMAIL_PASS` | Gmail App Password (from Google Account ‚Üí Security ‚Üí 2FA ‚Üí App Passwords) |
| `PORT` | Port to run the app (default: 5000) |

> ‚ö†Ô∏è **Never share your `.env` file or Gmail App Password publicly.**

### üìÑ Explanation of Key Directories and Files

- **`prisma/`**: Contains Prisma's schema (`schema.prisma`) and migration files. After each schema change, migration files are generated here to apply database changes.
- **`public/`**: Contains the frontend HTML file. This file interacts with the backend API for user registration, login, logout and todo management.
- **`src/`**: The core backend code.
  - **`generated/prisma/`**: Files and folders generated by prisma after running npx prisma generate. Do not touch this directory.
  - **`controllers/`** (optional): A directory to organize logic and separate it from the routes if needed in the future.
  - **`middlewares/`**: Contains middleware for handling JWT-based authentication, protecting routes that require authentication.
  - **`routes/`**: Contains API routes for handling authentication and CRUD operations for todos.
  - **`mailer.js`**: Configures the email reminder service and provider(gmail) using Nodemailer
  - **`prismaClient.js`**: Sets up the Prisma client for database interaction.
  - **`server.js`**: The entry point for the Express.js application, which configures the app, routes and middleware. This file also runs the cron-job for the email reminder system.
- **`.env`**: Stores environment variables like `DATABASE_URL`, `JWT_SECRET` and `EMAIL_PASS`. These variables are used to configure Prisma, JWT, Email reminder and database connections.
- **`Dockerfile`**: The Dockerfile for building the Node.js application in a containerized environment.
- **`docker-compose.yaml`**: Configuration for Docker Compose, which sets up both the Node.js app and PostgreSQL in separate containers.
- **`package.json`**: Defines the Node.js dependencies and scripts used to run the application (e.g., `npm start`).
- **`README.md`**: Project documentation, including setup instructions and directory structure (this file).

### Example Workflow

1. **Define or Update Schema**: Modify the `schema.prisma` file to change your database structure.
2. **Create Migrations**: Use Prisma to generate and apply migrations.
3. **Run Docker Compose**: Build and run the Node.js app and PostgreSQL using Docker Compose.
4. **Interact with the API**: Use the frontend or API client (e.g., Postman) to register, login, logout and manage todos.

This project structure and workflow will help organize your code and make it easier to maintain and scale as your application grows.

## üöÄ Getting Started

0. **Install Docker Desktop**

1. **Clone the Repository**:

```bash
git clone https://github.com/pratikk0501/todo-app-with-email-reminders.git
cd backend-todo-app
```

2. **Generate the Prisma Client**:

`npx prisma generate`

3. **Build your docker images**:

`docker compose build`

4. **Create PostgreSQL migrations and apply them**:

`docker compose run app npx prisma migrate dev --name init`

_Also_ - to run/apply migrations if necessary:

`docker-compose run app npx prisma migrate deploy`

5. **Boot up 2x docker containers**:

`docker compose up`

_or_

`docker compose up -d`

If you want to boot it up without it commandeering your terminal (you'll have to stop if via Docker Desktop though).

6. **To login to docker PostgreSQL database (from a new terminal instance while docker containers are running) where you can run SQL commands and modify database!**:

`docker exec -it postgres-db-zeidler psql -U postgres -d todoapp`

7. **To stop Docker containers**:

`docker compose down`

8. **To delete all docker containers**:

`docker system prune`

9. **Access the App**:

Open `http://localhost:5000` (or whatever PORT you choose) in your browser to see the frontend. You can register, log in, log out and manage your todo list from there.

## ‚ö†Ô∏è Important Notes

* Upon first time running the app, you may directly enter the todo page skipping the authentication. If so, logout, signup, then login to enter the app.
* While signing up, if it throws the 'Service Unavailable' error, ignore it, go to the login window and submit.
* Always input the due before field in the `yyyy:mm:dd hh:mm:ss` format or the app will not detect the date.
* Password must be atleast 8 characters and email should include '@'.

## üéØ Conclusion

This guide covers the main components of the app and how to get it up and running on your local machine. It highlights key considerations for Node.js version compatibility.and important environment variables need to be considered. You can now explore the app's functionality, including authentication and CRUD operations on todos!
